{{/*  Source: https://gitlab.com/Roneo/hugo-shortcode-roneo-fetch-archive.org  */}}

{{- $src := .Get "src" -}}
{{ $dataJ := getJSON $src }}
{{- $identifier := $dataJ.metadata.identifier -}}
{{- $root := "https://archive.org/download" -}}

{{ range $dataJ.files }}
  <ul>
      <li>
        {{$path := print $root "/" $identifier "/" .name}}
        <a href="{{ $path }}" target="_blank" aria-label="Télécharger {{ index .name }}" download>{{ index .name }}</a>
        <br>

        {{ if eq .Params.format "VBR MP3" }}
          <figure>
            <audio controls class="player">
              <source src="{{- $path -}}" type="audio/mpeg">
            </audio>
          </figure>
        {{ end }}

        {{ if in .source "original" }}
          <b>ORIGINAL</b>
        {{ end }}
        {{ if in .format "Text PDF" }}
          <b>PDF</b>
        {{ end }}
      </li>
  </ul>
{{ end }}
